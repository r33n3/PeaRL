{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://pearl.local/schemas/project/org-baseline.schema.json",
  "title": "OrgBaseline",
  "description": "AIUC-1 structured governance baseline for a PeaRL project.",
  "type": "object",
  "additionalProperties": false,
  "properties": {
    "schema_version": {
      "$ref": "../common/common-defs.schema.json#/$defs/schema_version"
    },
    "kind": { "const": "PearlOrgBaseline" },
    "baseline_id": {
      "type": "string",
      "pattern": "^orgb_[A-Za-z0-9_-]+$"
    },
    "org_name": { "type": "string" },
    "defaults": {
      "type": "object",
      "additionalProperties": false,
      "required": ["data_privacy", "security", "safety", "reliability", "accountability", "society"],
      "properties": {
        "data_privacy": {
          "$ref": "#/$defs/DataPrivacyDefaults"
        },
        "security": {
          "$ref": "#/$defs/SecurityDefaults"
        },
        "safety": {
          "$ref": "#/$defs/SafetyDefaults"
        },
        "reliability": {
          "$ref": "#/$defs/ReliabilityDefaults"
        },
        "accountability": {
          "$ref": "#/$defs/AccountabilityDefaults"
        },
        "society": {
          "$ref": "#/$defs/SocietyDefaults"
        }
      }
    },
    "environment_defaults": {
      "type": "object",
      "additionalProperties": false,
      "patternProperties": {
        "^(sandbox|dev|pilot|preprod|prod)$": {
          "type": "object",
          "additionalProperties": true
        }
      }
    },
    "environment_requirements": {
      "$ref": "#/$defs/EnvironmentRequirements"
    },
    "created_at": {
      "$ref": "../common/common-defs.schema.json#/$defs/timestamp"
    },
    "updated_at": {
      "$ref": "../common/common-defs.schema.json#/$defs/timestamp"
    },
    "integrity": {
      "$ref": "../common/common-defs.schema.json#/$defs/integrity"
    }
  },
  "required": ["schema_version", "kind", "baseline_id", "org_name", "defaults"],
  "$defs": {
    "boolField": { "type": ["boolean", "null"] },
    "EnvironmentRequirements": {
      "type": "object",
      "additionalProperties": false,
      "description": "AIUC-1 sub-control references (dot-notation) required to be True before promotion to each environment.",
      "properties": {
        "sandbox": { "type": "array", "items": { "type": "string" } },
        "dev":     { "type": "array", "items": { "type": "string" } },
        "preprod": { "type": "array", "items": { "type": "string" } },
        "prod":    { "type": "array", "items": { "type": "string" } }
      }
    },
    "DataPrivacyDefaults": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "a001_1_policy_documentation":            { "$ref": "#/$defs/boolField" },
        "a001_2_data_retention_implementation":   { "$ref": "#/$defs/boolField" },
        "a001_3_data_subject_right_processes":    { "$ref": "#/$defs/boolField" },
        "a002_1_output_usage_ownership_policy":   { "$ref": "#/$defs/boolField" },
        "a003_1_data_collection_scoping":         { "$ref": "#/$defs/boolField" },
        "a003_2_alerting_for_auth_failures":      { "$ref": "#/$defs/boolField" },
        "a003_3_authorization_system_integration":{ "$ref": "#/$defs/boolField" },
        "a004_1_user_guidance_on_confidential_info": { "$ref": "#/$defs/boolField" },
        "a004_2_foundational_model_ip_protections":  { "$ref": "#/$defs/boolField" },
        "a004_3_ip_detection_implementation":     { "$ref": "#/$defs/boolField" },
        "a004_4_ip_disclosure_monitoring":        { "$ref": "#/$defs/boolField" },
        "a005_1_consent_for_combined_data":       { "$ref": "#/$defs/boolField" },
        "a005_2_customer_data_isolation":         { "$ref": "#/$defs/boolField" },
        "a005_3_privacy_enhancing_controls":      { "$ref": "#/$defs/boolField" },
        "a006_1_pii_detection_filtering":         { "$ref": "#/$defs/boolField" },
        "a006_2_pii_access_controls":             { "$ref": "#/$defs/boolField" },
        "a006_3_dlp_system_integration":          { "$ref": "#/$defs/boolField" },
        "a007_1_model_provider_ip_protections":   { "$ref": "#/$defs/boolField" },
        "a007_2_ip_infringement_filtering":       { "$ref": "#/$defs/boolField" },
        "a007_3_user_facing_ip_notices":          { "$ref": "#/$defs/boolField" }
      }
    },
    "SecurityDefaults": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "b001_1_adversarial_testing_report":          { "$ref": "#/$defs/boolField" },
        "b001_2_security_program_integration":        { "$ref": "#/$defs/boolField" },
        "b002_1_adversarial_input_detection_alerting":{ "$ref": "#/$defs/boolField" },
        "b002_2_adversarial_incident_response":       { "$ref": "#/$defs/boolField" },
        "b002_3_detection_config_updates":            { "$ref": "#/$defs/boolField" },
        "b002_4_preprocessing_adversarial_detection": { "$ref": "#/$defs/boolField" },
        "b002_5_ai_security_alerts":                  { "$ref": "#/$defs/boolField" },
        "b003_1_technical_disclosure_guidelines":     { "$ref": "#/$defs/boolField" },
        "b003_2_public_disclosure_approval_records":  { "$ref": "#/$defs/boolField" },
        "b004_1_anomalous_usage_detection":           { "$ref": "#/$defs/boolField" },
        "b004_2_rate_limits":                         { "$ref": "#/$defs/boolField" },
        "b004_3_external_pentest_ai_endpoints":       { "$ref": "#/$defs/boolField" },
        "b004_4_vulnerability_remediation":           { "$ref": "#/$defs/boolField" },
        "b005_1_input_filtering":                     { "$ref": "#/$defs/boolField" },
        "b005_2_input_moderation_approach":           { "$ref": "#/$defs/boolField" },
        "b005_3_warning_for_blocked_inputs":          { "$ref": "#/$defs/boolField" },
        "b005_4_input_filtering_logs":                { "$ref": "#/$defs/boolField" },
        "b005_5_input_filter_performance":            { "$ref": "#/$defs/boolField" },
        "b006_1_agent_service_access_restrictions":   { "$ref": "#/$defs/boolField" },
        "b006_2_agent_security_monitoring_alerting":  { "$ref": "#/$defs/boolField" },
        "b007_1_user_access_controls":                { "$ref": "#/$defs/boolField" },
        "b007_2_access_reviews":                      { "$ref": "#/$defs/boolField" },
        "b008_1_model_access_controls":               { "$ref": "#/$defs/boolField" },
        "b008_2_api_deployment_security":             { "$ref": "#/$defs/boolField" },
        "b008_3_model_hosting_security":              { "$ref": "#/$defs/boolField" },
        "b008_4_model_integrity_verification":        { "$ref": "#/$defs/boolField" },
        "b009_1_output_volume_limits":                { "$ref": "#/$defs/boolField" },
        "b009_2_user_output_notices":                 { "$ref": "#/$defs/boolField" },
        "b009_3_output_precision_controls":           { "$ref": "#/$defs/boolField" }
      }
    },
    "SafetyDefaults": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "c001_1_risk_taxonomy":                       { "$ref": "#/$defs/boolField" },
        "c001_2_risk_taxonomy_reviews":               { "$ref": "#/$defs/boolField" },
        "c002_1_pre_deployment_test_approval":        { "$ref": "#/$defs/boolField" },
        "c002_2_sdlc_integration":                    { "$ref": "#/$defs/boolField" },
        "c002_3_vulnerability_scan_results":          { "$ref": "#/$defs/boolField" },
        "c003_1_harmful_output_filtering":            { "$ref": "#/$defs/boolField" },
        "c003_2_guardrails_for_high_risk_advice":     { "$ref": "#/$defs/boolField" },
        "c003_3_guardrails_for_biased_outputs":       { "$ref": "#/$defs/boolField" },
        "c003_4_filtering_performance_benchmarks":    { "$ref": "#/$defs/boolField" },
        "c004_1_out_of_scope_guardrails":             { "$ref": "#/$defs/boolField" },
        "c004_2_out_of_scope_attempt_logs":           { "$ref": "#/$defs/boolField" },
        "c004_3_user_guidance_on_scope":              { "$ref": "#/$defs/boolField" },
        "c005_1_risk_detection_response":             { "$ref": "#/$defs/boolField" },
        "c005_2_human_review_workflows":              { "$ref": "#/$defs/boolField" },
        "c005_3_automated_response_mechanisms":       { "$ref": "#/$defs/boolField" },
        "c006_1_output_sanitization":                 { "$ref": "#/$defs/boolField" },
        "c006_2_warning_labels_untrusted_content":    { "$ref": "#/$defs/boolField" },
        "c006_3_adversarial_output_detection":        { "$ref": "#/$defs/boolField" },
        "c007_1_high_risk_criteria_definition":       { "$ref": "#/$defs/boolField" },
        "c007_2_high_risk_detection_mechanisms":      { "$ref": "#/$defs/boolField" },
        "c007_3_human_review_for_high_risk":          { "$ref": "#/$defs/boolField" },
        "c008_1_risk_monitoring_logs":                { "$ref": "#/$defs/boolField" },
        "c008_2_monitoring_findings_documentation":   { "$ref": "#/$defs/boolField" },
        "c008_4_security_tooling_integration":        { "$ref": "#/$defs/boolField" },
        "c009_1_user_intervention_mechanisms":        { "$ref": "#/$defs/boolField" },
        "c009_2_feedback_intervention_reviews":       { "$ref": "#/$defs/boolField" },
        "c010_1_harmful_output_testing_report":       { "$ref": "#/$defs/boolField" },
        "c011_1_outofscope_output_testing_report":    { "$ref": "#/$defs/boolField" },
        "c012_1_customer_risk_testing_report":        { "$ref": "#/$defs/boolField" }
      }
    },
    "ReliabilityDefaults": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "d001_1_groundedness_filter":                 { "$ref": "#/$defs/boolField" },
        "d001_2_user_citations_source_attribution":   { "$ref": "#/$defs/boolField" },
        "d001_3_user_uncertainty_labels":             { "$ref": "#/$defs/boolField" },
        "d002_1_hallucination_testing_report":        { "$ref": "#/$defs/boolField" },
        "d003_1_tool_authorization_validation":       { "$ref": "#/$defs/boolField" },
        "d003_2_rate_limits_for_tools":               { "$ref": "#/$defs/boolField" },
        "d003_3_tool_call_log":                       { "$ref": "#/$defs/boolField" },
        "d003_4_human_approval_workflows":            { "$ref": "#/$defs/boolField" },
        "d003_5_tool_call_log_reviews":               { "$ref": "#/$defs/boolField" },
        "d004_1_tool_call_testing_report":            { "$ref": "#/$defs/boolField" }
      }
    },
    "AccountabilityDefaults": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "e001_1_security_breach_failure_plan":        { "$ref": "#/$defs/boolField" },
        "e002_1_harmful_output_failure_plan":         { "$ref": "#/$defs/boolField" },
        "e002_2_harmful_output_failure_procedures":   { "$ref": "#/$defs/boolField" },
        "e003_1_hallucination_failure_plan":          { "$ref": "#/$defs/boolField" },
        "e003_2_hallucination_failure_procedures":    { "$ref": "#/$defs/boolField" },
        "e004_1_change_approval_policy_records":      { "$ref": "#/$defs/boolField" },
        "e004_2_code_signing_implementation":         { "$ref": "#/$defs/boolField" },
        "e005_1_deployment_decisions":                { "$ref": "#/$defs/boolField" },
        "e006_1_vendor_due_diligence":                { "$ref": "#/$defs/boolField" },
        "e008_1_internal_review_documentation":       { "$ref": "#/$defs/boolField" },
        "e008_2_external_feedback_integration":       { "$ref": "#/$defs/boolField" },
        "e009_1_third_party_access_monitoring":       { "$ref": "#/$defs/boolField" },
        "e010_1_acceptable_use_policy":               { "$ref": "#/$defs/boolField" },
        "e010_2_aup_violation_detection":             { "$ref": "#/$defs/boolField" },
        "e010_3_user_notification_for_aup_breaches":  { "$ref": "#/$defs/boolField" },
        "e010_4_guardrails_enforcing_acceptable_use": { "$ref": "#/$defs/boolField" },
        "e011_1_ai_processing_locations":             { "$ref": "#/$defs/boolField" },
        "e011_2_data_transfer_compliance":            { "$ref": "#/$defs/boolField" },
        "e012_1_regulatory_compliance_reviews":       { "$ref": "#/$defs/boolField" },
        "e013_1_quality_objectives_risk_management":  { "$ref": "#/$defs/boolField" },
        "e013_2_change_management_procedures":        { "$ref": "#/$defs/boolField" },
        "e013_3_issue_tracking_monitoring":           { "$ref": "#/$defs/boolField" },
        "e013_4_data_management_procedures":          { "$ref": "#/$defs/boolField" },
        "e013_5_stakeholder_communication_procedures":{ "$ref": "#/$defs/boolField" },
        "e015_1_logging_implementation":              { "$ref": "#/$defs/boolField" },
        "e015_2_log_storage":                         { "$ref": "#/$defs/boolField" },
        "e015_3_log_integrity_protection":            { "$ref": "#/$defs/boolField" },
        "e016_1_text_ai_disclosure":                  { "$ref": "#/$defs/boolField" },
        "e016_2_voice_ai_disclosure":                 { "$ref": "#/$defs/boolField" },
        "e016_3_labelling_ai_generated_content":      { "$ref": "#/$defs/boolField" },
        "e016_4_automation_ai_disclosure":            { "$ref": "#/$defs/boolField" },
        "e016_5_system_response_to_ai_inquiry":       { "$ref": "#/$defs/boolField" },
        "e017_1_transparency_policy":                 { "$ref": "#/$defs/boolField" },
        "e017_2_model_cards_system_documentation":    { "$ref": "#/$defs/boolField" },
        "e017_3_transparency_report_sharing_policy":  { "$ref": "#/$defs/boolField" }
      }
    },
    "SocietyDefaults": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "f001_1_foundation_model_cyber_capabilities": { "$ref": "#/$defs/boolField" },
        "f001_2_cyber_use_detection":                 { "$ref": "#/$defs/boolField" },
        "f002_1_foundation_model_cbrn_capabilities":  { "$ref": "#/$defs/boolField" },
        "f002_2_catastrophic_misuse_monitoring":      { "$ref": "#/$defs/boolField" }
      }
    }
  }
}
